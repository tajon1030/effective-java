# 아이템 85,86: 자바 직렬화의 대안을 찾으라 & Serializable을 구현할지는 신중히 결정하라

> 직렬화는 위험하니 피해야한다.  
> 시스템을 밑바닥부터 설계한다면 JSON이나 프로토콜 버퍼와 같은 대안을 사용하자.  
> 신뢰할 수 없는 데이터는 역직렬화하지말자.  
> 꼭 해야한다면 객체 역직렬화 필터링을 사용하되, 이마저도 모든 공격을 막아줄 수 없음을 기억하자.  
> 클래스가 직렬화를 지원하도록 만들지 말고, 꼭 그렇게 만들어야한다면 정말 신경써서 작성해야한다.  

특정 라이브러리를 도입하면 JSON 또는 CSV 등 형태의 포맷으로 쉽게 개발이 가능하지만  
구조가 복잡하면 직접 매핑시켜줘야하는 번거로운 작업이 발생하기도 합니다.  
그것에 비해 자바 직렬화는 java.io.Serializable 인터페이스만 구현해주면 직렬화와 역직렬화를 할 수 있다는 장점이 있습니다.  

그렇지만 자바 직렬화를 사용하면 보이지않는 생성자, API와 구현사이의 모호해진 경계, 잠재적 정확성 문제, 성능, 보안, 유지보수성 등의 대가가 매우 큽니다.  
일례로 Serializable을 구현하여 릴리스 하면 하나의 공개 API가 되는것이기때문에 수정하기가 어려워집니다. (+아이템86 내용 추가 필요)

또한 신뢰할수없는 스트림을 역직렬화한다면 원격코드실행(RCE), 서비스거부(Dos) 등의 공격으로 이어질 수 있습니다.  

신뢰할수없는 바이트스트림을 역직렬화하는 일 자체가 스스로를 공격에 노출하는 행위이므로 가장 좋은 방법은 아무것도 역직렬화하지않는것이고,  
레거시 시스템 때문에 자바 직렬화를 완전히 배제할 수 없을때의 차선책은 신뢰할수 없는 데이터는 절대 역직렬화 하지 않는것이며  
java.io.ObjectInputFilter라는 객체 역직렬화 필터링으로 화이트리스트방식을 사용하여 안전하다고 알려진 클래스만 수용할수있도록 하도록 합시다.  

## 참고
[자바 직렬화, 그것이 알고싶다. 훑어보기편](https://techblog.woowahan.com/2550/)  
[자바 직렬화, 그것이 알고싶다. 실무편](https://techblog.woowahan.com/2551/)  